@prefix fhir: <http://hl7.org/fhir/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sct: <http://snomed.info/id/> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

# - resource -------------------------------------------------------------------

<http://hl7.org/fhir/ChargeItemDefinition/device> a fhir:ChargeItemDefinition ;
  fhir:nodeRole fhir:treeRoot ;
  fhir:id [ fhir:v "device"] ; # 
  fhir:extension ( [
     fhir:url [ fhir:v "http://hl7.org/fhir/StructureDefinition/structuredefinition-wg"^^xsd:anyURI ] ;
     fhir:value [
       a fhir:Code ;
       fhir:v "pa"
     ]
  ] ) ; # 
  fhir:url [ fhir:v "http://sap.org/ChargeItemDefinition/device-123"^^xsd:anyURI] ; # 
  fhir:identifier ( [
     fhir:system [ fhir:v "urn:ietf:rfc:3986"^^xsd:anyURI ] ;
     fhir:value [ fhir:v "urn:oid:2.16.840.1.113883.4.642.29.2" ]
  ] ) ; # 
  fhir:name [ fhir:v "CustomDevice345675"] ; # 
  fhir:title [ fhir:v "Financial details for custom made device (345675)"] ; # 
  fhir:status [ fhir:v "active"] ; # 
  fhir:date [ fhir:v "2023-02"^^xsd:gYearMonth] ; # 
  fhir:publisher [ fhir:v "HL7 International / Patient Administration"] ; # 
  fhir:contact ( [
     fhir:telecom ( [
       fhir:system [ fhir:v "url" ] ;
       fhir:value [ fhir:v "http://www.hl7.org/Special/committees/pafm" ]
     ] )
  ] ) ; # 
  fhir:description [ fhir:v "Financial details for custom made device"] ; # 
  fhir:useContext ( [
     fhir:code [
       fhir:system [ fhir:v "http://terminology.hl7.org/CodeSystem/usage-context-type"^^xsd:anyURI ] ;
       fhir:code [ fhir:v "venue" ]
     ] ;
     fhir:value [
       a fhir:CodeableConcept ;
       fhir:coding ( [
         a sct:440655000 ;
         fhir:system [ fhir:v "http://snomed.info/sct"^^xsd:anyURI ] ;
         fhir:code [ fhir:v "440655000" ] ;
         fhir:display [ fhir:v "Outpatient environment" ]
       ] )
     ]
  ] [
     fhir:code [
       fhir:system [ fhir:v "http://terminology.hl7.org/CodeSystem/usage-context-type"^^xsd:anyURI ] ;
       fhir:code [ fhir:v "age" ]
     ] ;
     fhir:value [
       a fhir:Quantity ;
       fhir:value [ fhir:v "18"^^xsd:decimal ] ;
       fhir:comparator [ fhir:v ">" ] ;
       fhir:unit [ fhir:v "yrs" ] ;
       fhir:system [ fhir:v "http://unitsofmeasure.org"^^xsd:anyURI ] ;
       fhir:code [ fhir:v "a" ]
     ]
  ] ) ; # 
  fhir:jurisdiction ( [
     fhir:coding ( [
       fhir:system [ fhir:v "http://unstats.un.org/unsd/methods/m49/m49.htm"^^xsd:anyURI ] ;
       fhir:code [ fhir:v "001" ] ;
       fhir:display [ fhir:v "World" ]
     ] )
  ] ) ; # 
  fhir:instance ( [
     fhir:link <http://hl7.org/fhir/Device/example> ;
     fhir:reference [ fhir:v "Device/example" ]
  ] ) ; # 
  fhir:applicability ( [
     fhir:condition [
       fhir:description [ fhir:v "Verify ChargeItem pertains to Device 12345" ] ;
       fhir:language [ fhir:v "text/fhirpath" ] ;
       fhir:expression [ fhir:v "%context.service.suppliedItem.reference='Device/12345'" ] #   syntax of expression may be incorrect, but you get the idea 
     ]
  ] ) ; #   definition only applicable if the ChargeItem pertains to the device this   
  fhir:propertyGroup ( [
     fhir:priceComponent ( [
       fhir:type [ fhir:v "base" ] ;
       fhir:code [
         fhir:coding ( [
           fhir:system [ fhir:v "http://fhir.de/CodeSystem/billing-attributes"^^xsd:anyURI ] ;
           fhir:code [ fhir:v "VK" ] ;
           fhir:display [ fhir:v "Verkaufspreis (netto)" ]
         ] )
       ] ;
       fhir:amount [
         fhir:value [ fhir:v 67.44 ] ;
         fhir:currency [ fhir:v "EUR" ]
       ]
     ] )
  ] [
     fhir:applicability ( [
       fhir:condition [
         fhir:description [ fhir:v "Gültigkeit Steuersatz" ] ;
         fhir:language [ fhir:v "text/fhirpath" ] ;
         fhir:expression [ fhir:v "%context.occurenceDateTime > '2018-04-01'" ] #   syntax of expression may be incorrect, but you get the idea 
       ]
     ] ) ;
     fhir:priceComponent ( [
       fhir:type [ fhir:v "tax" ] ;
       fhir:code [
         fhir:coding ( [
           fhir:system [ fhir:v "http://fhir.de/CodeSystem/billing-attributes"^^xsd:anyURI ] ;
           fhir:code [ fhir:v "MWST" ] ;
           fhir:display [ fhir:v "Mehrwersteuersatz" ]
         ] )
       ] ;
       fhir:factor [ fhir:v 1.19 ]
     ] )
  ] [
     fhir:applicability ( [
       fhir:condition [
         fhir:description [ fhir:v "Gültigkeit Steuersatz" ] ;
         fhir:language [ fhir:v "text/fhirpath" ] ;
         fhir:expression [ fhir:v "%context.occurenceDateTime <= '2018-04-01'" ] #   syntax of expression may be incorrect, but you get the idea 
       ]
     ] ) ;
     fhir:priceComponent ( [
       fhir:type [ fhir:v "tax" ] ;
       fhir:code [
         fhir:coding ( [
           fhir:system [ fhir:v "http://fhir.de/CodeSystem/billing-attributes"^^xsd:anyURI ] ;
           fhir:code [ fhir:v "MWST" ] ;
           fhir:display [ fhir:v "Mehrwersteuersatz" ]
         ] )
       ] ;
       fhir:factor [ fhir:v 1.07 ]
     ] )
  ] ) . #   the base price for this device is constant, so no additional rules apply 

<http://hl7.org/fhir/Device/example> a fhir:Device .

# -------------------------------------------------------------------------------------

